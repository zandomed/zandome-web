---
import {
  SERVICE_AD_PERSONALIZATION,
  SERVICE_AD_STORAGE,
  SERVICE_AD_USER_DATA,
  SERVICE_ANALYTICS_STORAGE,
  SERVICE_FUNCTIONALITY_STORAGE,
  SERVICE_PERSONALIZATION_STORAGE,
  SERVICE_SECURITY_STORAGE,
} from '../CookieConsent/CookieConsentConfig.ts';
const GOOGLE_ANALYTICS_ID = import.meta.env.ANALYTICS_GOOGLE_ID;
---

<script
  is:inline
  type="text/partytown"
  src={`https://www.googletagmanager.com/gtag/js?id=${GOOGLE_ANALYTICS_ID}`}></script>
<script
  is:inline
  type="text/partytown"
  define:vars={{
    SERVICE_AD_PERSONALIZATION,
    SERVICE_AD_STORAGE,
    SERVICE_AD_USER_DATA,
    SERVICE_ANALYTICS_STORAGE,
    SERVICE_FUNCTIONALITY_STORAGE,
    SERVICE_PERSONALIZATION_STORAGE,
    SERVICE_SECURITY_STORAGE,
    GOOGLE_ANALYTICS_ID,
  }}
>
  window.dataLayer = window.dataLayer || [];
  window.gtag = function gtag() {
    window.dataLayer.push(arguments);
  };

  window.gtag('js', new Date());

  window.gtag('consent', 'default', {
    [SERVICE_AD_STORAGE]: 'denied',
    [SERVICE_AD_USER_DATA]: 'denied',
    [SERVICE_AD_PERSONALIZATION]: 'denied',
    [SERVICE_ANALYTICS_STORAGE]: 'denied',
    [SERVICE_FUNCTIONALITY_STORAGE]: 'denied',
    [SERVICE_PERSONALIZATION_STORAGE]: 'denied',
    [SERVICE_SECURITY_STORAGE]: 'denied',
  });

  window.gtag('config', GOOGLE_ANALYTICS_ID, {
    page_path: window.location.pathname,
  });
</script>
